<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Select Items - Brewline</title>
<link rel="stylesheet" href="assets/css/style.css?v=2">
</head>
<body>

<header>
<div class="nav">
<img src="assets/images/logo.png" class="logo" alt="Logo">
<div>
<a href="index.html">Home</a>
<a href="menu.html">Menu</a>
<a href="reservation.html">Reservations</a>
<a href="contact.html">Contact Us</a>
</div>
</div>
</header>

<section class="delivery-section">
<div class="container">

<h2>Choose Your Items</h2>
<p>Select your drinks. Your total updates automatically.</p>

<div class="menu-accordion">

<!-- FUNCTION TO GENERATE ITEM -->
<script>
function createItem(name){
return `
<div class="menu-item">
  <div class="item-top">
    <span class="item-name">${name}</span>
    <div class="qty-box">
      <button class="qty-btn minus">-</button>
      <input class="qty" type="number" min="0" value="0" data-name="${name}" data-price="2">
      <button class="qty-btn plus">+</button>
    </div>
  </div>
  <textarea class="item-note" placeholder="Special instructions..."></textarea>
</div>`;
}
</script>

<!-- CATEGORY TEMPLATE -->

<button class="acc-btn category-title">Hot Coffee</button>
<div class="acc-panel">
<script>
document.write(
createItem("Espresso") +
createItem("Macchiato") +
createItem("Americano") +
createItem("Filtered Coffee") +
createItem("French Press") +
createItem("Lebanese Rakwa")
);
</script>
</div>

<button class="acc-btn category-title">Latte</button>
<div class="acc-panel">
<script>
document.write(
createItem("Flat White") +
createItem("Cappuccino") +
createItem("Cafe Latte") +
createItem("Spanish Latte") +
createItem("Matcha Latte") +
createItem("Flavored Latte")
);
</script>
</div>

<button class="acc-btn category-title">Iced Coffee</button>
<div class="acc-panel">
<script>
document.write(
createItem("Iced Americano") +
createItem("Iced Latte") +
createItem("Iced Spanish Latte") +
createItem("Iced Matcha Latte") +
createItem("Iced Flavored Latte")
);
</script>
</div>

<button class="acc-btn category-title">Frappe</button>
<div class="acc-panel">
<script>
document.write(
createItem("Mocha Frappe") +
createItem("Caramel Frappe") +
createItem("Salted Caramel Frappe") +
createItem("Amber Musk Frappe") +
createItem("Lotus Frappe") +
createItem("Cookies & Creme Frappe") +
createItem("Matcha Frappe")
);
</script>
</div>

<button class="acc-btn category-title">Smoothies</button>
<div class="acc-panel">
<script>
document.write(
createItem("Mango Smoothie") +
createItem("Strawberry Smoothie") +
createItem("Mix Berries Smoothie")
);
</script>
</div>

<button class="acc-btn category-title">Milkshakes</button>
<div class="acc-panel">
<script>
document.write(
createItem("Lotus Milkshake") +
createItem("Chocolate Milkshake") +
createItem("Cookies & Cream Milkshake") +
createItem("Vanilla Strawberry Milkshake")
);
</script>
</div>

<button class="acc-btn category-title">Brewline Specials</button>
<div class="acc-panel">
<script>
document.write(
createItem("Strawberry Matcha Latte") +
createItem("Pumpkin Spice Latte") +
createItem("Beauty Glow") +
createItem("Black Lemonade")
);
</script>
</div>

<button class="acc-btn category-title">Non-Coffee</button>
<div class="acc-panel">
<script>
document.write(
createItem("Hot Chocolate") +
createItem("White Hot Chocolate") +
createItem("Green Tea") +
createItem("Ginger Tea") +
createItem("Lemon Tea") +
createItem("Jasmine Tea")
);
</script>
</div>

<button class="acc-btn category-title">Add-Ons</button>
<div class="acc-panel">
<script>
document.write(
createItem("Extra Shot") +
createItem("Extra Syrup") +
createItem("Add Cream") +
createItem("Almond Milk") +
createItem("Oat Milk") +
createItem("Soya Milk") +
createItem("Coconut Milk")
);
</script>
</div>

</div>

<h3>Order Summary</h3>
<div id="order-summary"><p>No items selected.</p></div>
<h3>Total: $<span id="total-price">0</span></h3>

<p id="cart-error" class="cart-error"></p>

<div class="proceed-wrap">
<button id="proceedBtn" class="delivery-btn">
Proceed to Checkout
</button>
</div>

</div>
</section>

<script>

/* Accordion */
document.querySelectorAll(".acc-btn").forEach(btn=>{
btn.addEventListener("click",()=>{
btn.classList.toggle("active");
btn.nextElementSibling.classList.toggle("open");
});
});

/* Quantity buttons */
document.addEventListener("click", function(e){
if(e.target.classList.contains("plus")){
let input = e.target.parentElement.querySelector(".qty");
input.value = parseInt(input.value) + 1;
updateCart();
}
if(e.target.classList.contains("minus")){
let input = e.target.parentElement.querySelector(".qty");
if(parseInt(input.value) > 0){
input.value = parseInt(input.value) - 1;
updateCart();
}
}
});

const summary = document.getElementById("order-summary");
const totalDisplay = document.getElementById("total-price");
const errorMsg = document.getElementById("cart-error");

function updateCart(){
let total = 0;
let cart = [];
summary.innerHTML = "";

document.querySelectorAll(".qty").forEach(input=>{
let qty = parseInt(input.value);
let name = input.dataset.name;
let price = 2;
let note = input.closest(".menu-item").querySelector(".item-note").value;

if(qty > 0){
let lineTotal = qty * price;
total += lineTotal;
cart.push({name, qty, note, lineTotal});

let p = document.createElement("p");
p.textContent = `${name} x${qty} = $${lineTotal}`;
summary.appendChild(p);
}
});

if(cart.length === 0){
summary.innerHTML = "<p>No items selected.</p>";
}

localStorage.setItem("brewline_cart", JSON.stringify(cart));
localStorage.setItem("brewline_total", total);
totalDisplay.textContent = total;
}

document.addEventListener("input", function(e){
if(e.target.classList.contains("qty")){
updateCart();
}
});

document.getElementById("proceedBtn").addEventListener("click", function(){
let cart = JSON.parse(localStorage.getItem("brewline_cart")) || [];
if(cart.length === 0){
errorMsg.innerHTML = "Your cart is currently empty.<br>Please select at least one item to continue.";
return;
}
window.location.href = "checkout.html";
});

</script>

</body>
</html>
