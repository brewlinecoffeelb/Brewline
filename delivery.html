<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Select Items - Brewline</title>
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

<header>
<div class="nav">
<img src="assets/images/logo.png" class="logo" alt="Logo">
<div>
<a href="index.html">Home</a>
<a href="menu.html">Menu</a>
<a href="reservation.html">Reservations</a>
<a href="contact.html">Contact Us</a>
</div>
</div>
</header>

<section class="delivery-section">
<div class="container">

<h2>Choose Your Items</h2>
<p>Select your drinks. Your total updates automatically.</p>

<div class="menu-accordion">

<!-- CATEGORY TEMPLATE -->
<!-- HOT COFFEE -->
<button type="button" class="acc-btn category-title">Hot Coffee</button>
<div class="acc-panel">

<div class="menu-item">
<span>Espresso</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Espresso" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Macchiato</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Macchiato" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Americano</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Americano" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Filtered Coffee</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Filtered Coffee" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>French Press</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="French Press" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Lebanese Rakwa</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Lebanese Rakwa" data-price="2">
<button class="plus">+</button>
</div>
</div>

</div>

<!-- LATTE -->
<button type="button" class="acc-btn category-title">Latte</button>
<div class="acc-panel">

<div class="menu-item">
<span>Flat White</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Flat White" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Cappuccino</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Cappuccino" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Cafe Latte</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Cafe Latte" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Spanish Latte</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Spanish Latte" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Matcha Latte</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Matcha Latte" data-price="2">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Flavored Latte</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Flavored Latte" data-price="2">
<button class="plus">+</button>
</div>
</div>

</div>

<!-- SMOOTHIES -->
<button type="button" class="acc-btn category-title">Smoothies</button>
<div class="acc-panel">

<div class="menu-item">
<span>Mango Smoothie</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Mango Smoothie" data-price="3">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Strawberry Smoothie</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Strawberry Smoothie" data-price="3">
<button class="plus">+</button>
</div>
</div>

<div class="menu-item">
<span>Mix Berries Smoothie</span>
<div class="qty-box">
<button class="minus">-</button>
<input class="qty" type="number" min="0" value="0" data-name="Mix Berries Smoothie" data-price="3">
<button class="plus">+</button>
</div>
</div>

</div>

</div>

<!-- GLOBAL SPECIAL INSTRUCTIONS -->
<div style="margin-top:40px;">
<h3>Special Instructions</h3>
<textarea id="global-notes" placeholder="Special instructions..."></textarea>
</div>

<h3>Order Summary</h3>
<div id="order-summary"><p>No items selected.</p></div>
<h3>Total: $<span id="total-price">0</span></h3>

<p id="cart-error" class="cart-error"></p>

<div class="proceed-wrap">
<button id="proceedBtn" class="delivery-btn">
Proceed to Checkout
</button>
</div>

</div>
</section>

<script>

document.querySelectorAll(".acc-btn").forEach(btn => {
btn.addEventListener("click", () => {
btn.classList.toggle("active");
btn.nextElementSibling.classList.toggle("open");
});
});

/* PLUS & MINUS BUTTONS */
document.querySelectorAll(".plus").forEach(btn => {
btn.addEventListener("click", function() {
let input = this.parentElement.querySelector(".qty");
input.value = parseInt(input.value) + 1;
updateCart();
});
});

document.querySelectorAll(".minus").forEach(btn => {
btn.addEventListener("click", function() {
let input = this.parentElement.querySelector(".qty");
if(parseInt(input.value) > 0){
input.value = parseInt(input.value) - 1;
updateCart();
}
});
});

const qtyInputs = document.querySelectorAll(".qty");
const summary = document.getElementById("order-summary");
const totalDisplay = document.getElementById("total-price");
const errorMsg = document.getElementById("cart-error");

function updateCart() {

let total = 0;
let cart = [];
summary.innerHTML = "";

qtyInputs.forEach(input => {

let qty = parseInt(input.value);
let price = parseFloat(input.dataset.price);
let name = input.dataset.name;

if (qty > 0) {
let lineTotal = qty * price;
total += lineTotal;
cart.push({name, qty, lineTotal});

let p = document.createElement("p");
p.textContent = `${name} x${qty} = $${lineTotal}`;
summary.appendChild(p);
}
});

if (cart.length === 0) {
summary.innerHTML = "<p>No items selected.</p>";
localStorage.removeItem("brewline_cart");
localStorage.removeItem("brewline_total");
} else {
localStorage.setItem("brewline_cart", JSON.stringify(cart));
localStorage.setItem("brewline_total", total);
}

totalDisplay.textContent = total;
}

qtyInputs.forEach(input => input.addEventListener("input", updateCart));

document.getElementById("proceedBtn").addEventListener("click", function () {

const cart = JSON.parse(localStorage.getItem("brewline_cart")) || [];

if (cart.length === 0) {
errorMsg.innerHTML = `
Your cart is currently empty.<br>
Please select at least one item to continue.
`;
return;
}

localStorage.setItem("brewline_notes", document.getElementById("global-notes").value);

errorMsg.innerHTML = "";
window.location.href = "checkout.html";
});

</script>

</body>
</html>
